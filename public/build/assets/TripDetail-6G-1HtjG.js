import{r as o,u as Y,d as F,j as e,H as Ce,L as U,a as w}from"./app-CaSGj1uT.js";import{A as ke,g as W,S as De,C as Te,a as Se,d as qe,e as Le}from"./app-layout-Cy2scFGy.js";import{b,C as D,a as T,c as y,e as Z}from"./card-B5yYBXn0.js";import{B as r}from"./button-BZEXzofL.js";import{B as h}from"./badge-fjcL5lAh.js";import{I as N}from"./input-DS6fKu5u.js";import{L as C}from"./label-D5A-ek0L.js";import{T as Be}from"./textarea-DBZrNJqr.js";import{d as J,f as Q,c as _,D as ee,a as se,e as Ee,b as te}from"./dialog-C6DnRKYe.js";import{T as ae,a as ce,b as S,c as n,d as le,e as d}from"./table-CmhPySl3.js";import{T as He,a as $e,b as q,c as L}from"./tabs-BLO8y8qf.js";import{t as k}from"./index-D9FVAaNM.js";import{C as ie}from"./checkbox-Dw6fm8Su.js";import{A as Ae}from"./arrow-left-DWM__Iss.js";import{C as Me}from"./index-B35KFXzL.js";import{C as B}from"./circle-check-D6S4rrRZ.js";import{C as I}from"./clock-BZi_k4Xa.js";import{U as re,C as Ve}from"./users-BVM233CZ.js";import{F as g}from"./file-text-xLwrV0oL.js";import{c as ze}from"./createLucideIcon-B2IF2C91.js";import{P as ne}from"./plus-Cuh-3za3.js";import{C as de}from"./circle-x-B9zG9rAW.js";import{C as Fe}from"./index-5xdvLrBf.js";import{S as Ie}from"./save-DATlS4cM.js";import{M as Oe}from"./map-pin-ASbtl6oT.js";import{E as Ke}from"./eye-DB6MKcxJ.js";import{T as oe}from"./trash-2-7ovCRB6M.js";import"./app-C1CjLIM7.js";import"./utils-D0Zg16Wk.js";import"./index-P0NC3ElT.js";import"./index-Dc8D3YAC.js";import"./x-BJwh83_V.js";import"./avatar-y1YlfNVC.js";import"./index-Dhq0cQs_.js";import"./index-CMWG4mbA.js";import"./index-D9s5CDJa.js";import"./index-7ujUmCNw.js";import"./app-logo-icon-2KxTv0kJ.js";import"./index-31lGrPGR.js";import"./index-gSLmiL6w.js";import"./index-DaohGxKX.js";import"./index-2FGh3n-F.js";import"./index-CGelz8kl.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],Re=ze("FileDown",Ge),he={0:{label:"Chá» xÃ¡c nháº­n",color:"bg-yellow-100 text-yellow-800"},1:{label:"Äang thá»±c hiá»‡n",color:"bg-blue-100 text-blue-800"},2:{label:"HoÃ n thÃ nh",color:"bg-green-100 text-green-800"},3:{label:"ÄÃ£ há»§y",color:"bg-red-100 text-red-800"}},E={0:"NgÆ°á»i lá»›n",1:"Tráº» em",2:"Em bÃ©"};function $s({assignment:l,passengers:j}){const[H,$]=o.useState(!1),[xe,A]=o.useState(!1),[p,v]=o.useState([]),[me,O]=o.useState(!1),[x,u]=o.useState({}),[je,K]=o.useState(new Set),c=Y({title:"",checkin_time:new Date().toISOString().slice(0,16),passengers:[]}),m=Y({title:"",content:""}),M=o.useMemo(()=>{const s={};return p.forEach(t=>{const i=t.booking?.code||"KhÃ´ng cÃ³ booking";s[i]||(s[i]=[]),s[i].push(t)}),s},[p]),G=o.useMemo(()=>j.filter(s=>s.request&&s.request.trim()!=="").length,[j]),ue=o.useMemo(()=>j.filter(s=>s.request&&s.request.trim()!==""),[j]);o.useEffect(()=>{const s=Object.keys(M);K(new Set(s))},[M]),o.useEffect(()=>{const s={};p.forEach(t=>{s[t.id]={is_present:!1,notes:""}}),u(s)},[p]),o.useEffect(()=>{H&&c.data.checkin_time&&V(c.data.checkin_time)},[H]);const V=async s=>{if(c.setData("checkin_time",s),!s){v([]);return}O(!0);try{const t=await F.get(`/guide/trip/${l.id}/passengers`,{params:{checkin_time:s}});v(t.data)}catch(t){k.error("KhÃ´ng thá»ƒ táº£i danh sÃ¡ch khÃ¡ch hÃ ng"),console.error(t)}finally{O(!1)}},R=s=>{u(t=>({...t,[s]:{...t[s],is_present:!t[s]?.is_present}}))},X=(s,t)=>{u(i=>({...i,[s]:{...i[s],notes:t}}))},pe=s=>{K(t=>{const i=new Set(t);return i.has(s)?i.delete(s):i.add(s),i})},fe=s=>{s.preventDefault(),c.transform(t=>({...t,passengers:Object.entries(x).map(([i,f])=>({passenger_id:parseInt(i),is_present:f.is_present,notes:f.notes}))})),c.post(`/guide/trip/${l.id}/checkin`,{onSuccess:()=>{$(!1),c.reset(),v([]),u({}),w.reload()}})},Ne=s=>{s.preventDefault(),m.post(`/guide/trip/${l.id}/note`,{onSuccess:()=>{A(!1),m.reset()}})},ge=s=>{confirm("Báº¡n cÃ³ cháº¯c muá»‘n xÃ³a Ä‘á»£t check-in nÃ y?")&&w.delete(`/guide/checkin/${s}`)},ve=s=>{confirm("Báº¡n cÃ³ cháº¯c muá»‘n xÃ³a nháº­t kÃ½ nÃ y?")&&w.delete(`/guide/note/${s}`)},we=async()=>{try{await F.post(`/assignments/${l.id}/confirm`),k.success("ÄÃ£ xÃ¡c nháº­n nháº­n tour thÃ nh cÃ´ng!"),w.reload()}catch(s){k.error(s.response?.data?.message||"CÃ³ lá»—i xáº£y ra")}};o.useMemo(()=>{if(!l.tourInstance?.date_end)return!1;const s=new Date;s.setHours(0,0,0,0);const t=new Date(l.tourInstance.date_end);return t.setHours(0,0,0,0),s.getTime()>=t.getTime()},[l.tourInstance?.date_end]);const be=async()=>{if(confirm("Báº¡n cÃ³ cháº¯c muá»‘n xÃ¡c nháº­n Ä‘Ã£ káº¿t thÃºc tour? HÃ nh Ä‘á»™ng nÃ y khÃ´ng thá»ƒ hoÃ n tÃ¡c."))try{await F.post(`/guide/trip/${l.id}/complete`),k.success("ÄÃ£ xÃ¡c nháº­n káº¿t thÃºc tour thÃ nh cÃ´ng!"),w.reload()}catch(s){k.error(s.response?.data?.error||s.response?.data?.message||"CÃ³ lá»—i xáº£y ra")}};return e.jsxs(ke,{children:[e.jsx(Ce,{title:`Chi tiáº¿t chuyáº¿n Ä‘i - ${l.tour.title}`}),e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(U,{href:W.schedule(),children:e.jsx(r,{variant:"ghost",size:"icon",children:e.jsx(Ae,{className:"h-5 w-5"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex flex-col items-start gap-2 mb-2 sm:flex-row sm:items-center",children:[e.jsx(h,{className:he[l.status]?.color||"bg-gray-100",children:he[l.status]?.label||"KhÃ´ng xÃ¡c Ä‘á»‹nh"}),l.status==="0"&&e.jsxs(r,{onClick:we,size:"sm",className:"gap-2 w-full sm:w-auto justify-center",children:[e.jsx(Me,{className:"h-4 w-4"}),"XÃ¡c nháº­n Ä‘Ã£ nháº­n"]}),l.status==="1"&&e.jsxs(r,{onClick:be,size:"sm",className:"gap-2 bg-green-600 hover:bg-green-700 w-full sm:w-auto justify-center",children:[e.jsx(B,{className:"h-4 w-4"}),"XÃ¡c nháº­n Ä‘Ã£ káº¿t thÃºc tour"]})]}),e.jsx("h1",{className:"text-xl sm:text-2xl font-bold",children:l.tour.title}),e.jsxs("p",{className:"text-muted-foreground flex flex-wrap items-center gap-2 text-sm",children:[e.jsx(I,{className:"h-4 w-4"}),l.tour.days," ngÃ y",e.jsx("span",{className:"mx-2",children:"â€¢"}),e.jsx(re,{className:"h-4 w-4"}),j.length," khÃ¡ch",l.tourInstance&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-2",children:"â€¢"}),e.jsxs("span",{className:"font-medium text-blue-600",children:[new Date(l.tourInstance.date_start).toLocaleDateString("vi-VN")," - ",new Date(l.tourInstance.date_end).toLocaleDateString("vi-VN")]})]})]})]})]}),e.jsxs(He,{defaultValue:"itinerary",className:"w-full",children:[e.jsxs($e,{className:"w-full justify-start overflow-x-auto flex-nowrap h-auto p-1",children:[e.jsx(q,{value:"itinerary",className:"flex-1 min-w-[100px]",children:"Lá»‹ch trÃ¬nh"}),e.jsx(q,{value:"passengers",className:"flex-1 min-w-[100px]",children:"KhÃ¡ch hÃ ng"}),e.jsx(q,{value:"checkin",className:"flex-1 min-w-[100px]",children:"Check-in"}),e.jsx(q,{value:"notes",className:"flex-1 min-w-[100px]",children:"Nháº­t kÃ½"})]}),e.jsx(L,{value:"itinerary",className:"space-y-4",children:e.jsxs(b,{children:[e.jsx(D,{children:e.jsx(T,{children:"ðŸ“ Lá»‹ch trÃ¬nh chi tiáº¿t"})}),e.jsx(y,{children:l.tour.schedules.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"ChÆ°a cÃ³ lá»‹ch trÃ¬nh chi tiáº¿t"}):e.jsx("div",{className:"space-y-4",children:l.tour.schedules.sort((s,t)=>s.date-t.date).map(s=>e.jsxs("div",{className:"border-l-4 border-primary pl-4 py-2",children:[e.jsxs("div",{className:"font-semibold text-primary",children:["NgÃ y ",s.date,": ",s.name]}),s.destination&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["ðŸ“ ",s.destination.name]}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.description})]},s.id))})})]})}),e.jsxs(L,{value:"passengers",className:"space-y-4",children:[G>0&&e.jsx(b,{className:"border-orange-200 bg-orange-50",children:e.jsxs(y,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-orange-100",children:e.jsx(g,{className:"h-5 w-5 text-orange-600"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"font-semibold text-orange-900",children:["CÃ³ ",G," khÃ¡ch hÃ ng cÃ³ yÃªu cáº§u Ä‘áº·c biá»‡t"]}),e.jsx("p",{className:"text-sm text-orange-700 mt-1",children:"Vui lÃ²ng kiá»ƒm tra vÃ  Ä‘áº£m báº£o Ä‘Ã¡p á»©ng cÃ¡c yÃªu cáº§u nÃ y trong suá»‘t chuyáº¿n Ä‘i"})]})]}),e.jsx("div",{className:"mt-4 space-y-2",children:ue.map(s=>e.jsx("div",{className:"bg-white rounded-lg p-3 border border-orange-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(h,{variant:"outline",className:"bg-orange-100 text-orange-800 border-orange-300",children:s.booking?.code||"N/A"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:s.fullname}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s.request})]})]})},s.id))})]})}),e.jsxs(b,{children:[e.jsxs(D,{className:"flex flex-row items-center justify-between",children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-5 w-5"}),"Danh sÃ¡ch khÃ¡ch hÃ ng (",j.length,")"]}),e.jsxs(r,{variant:"outline",size:"sm",className:"gap-2 text-green-700 bg-green-50 border-green-200 hover:bg-green-100 hover:text-green-800",onClick:()=>window.location.href=`/guide/trip/${l.id}/export`,children:[e.jsx(Re,{className:"w-4 h-4"})," Xuáº¥t CSV"]})]}),e.jsx(y,{children:j.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"ChÆ°a cÃ³ khÃ¡ch hÃ ng nÃ o"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(ae,{children:[e.jsx(ce,{children:e.jsxs(S,{children:[e.jsx(n,{children:"#"}),e.jsx(n,{children:"Há» tÃªn"}),e.jsx(n,{children:"SÄT"}),e.jsx(n,{children:"CCCD"}),e.jsx(n,{children:"Loáº¡i"}),e.jsx(n,{children:"YÃªu cáº§u Ä‘áº·c biá»‡t"}),e.jsx(n,{children:"MÃ£ booking"})]})}),e.jsx(le,{children:j.map((s,t)=>e.jsxs(S,{children:[e.jsx(d,{children:t+1}),e.jsx(d,{className:"font-medium",children:s.fullname}),e.jsx(d,{className:"font-mono text-sm",children:s.phone||"-"}),e.jsx(d,{children:s.cccd||"-"}),e.jsx(d,{children:e.jsx(h,{variant:"outline",children:E[s.type]||"N/A"})}),e.jsx(d,{children:s.request&&s.request.trim()!==""?e.jsxs("div",{className:"max-w-[200px]",children:[e.jsxs(h,{variant:"outline",className:"bg-orange-50 text-orange-800 border-orange-300 text-xs",children:[e.jsx(g,{className:"h-3 w-3 mr-1"}),"CÃ³ yÃªu cáº§u"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 truncate",title:s.request,children:s.request})]}):e.jsx("span",{className:"text-muted-foreground text-sm",children:"-"})}),e.jsx(d,{children:e.jsx(h,{variant:"secondary",children:s.booking?.code||"-"})})]},s.id))})]})}),e.jsx("div",{className:"md:hidden space-y-4",children:j.map((s,t)=>e.jsxs("div",{className:"bg-white border rounded-lg p-4 space-y-3 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm font-semibold text-gray-500",children:["#",t+1]}),e.jsx("h3",{className:"font-bold text-gray-900",children:s.fullname})]}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx(h,{variant:"outline",className:"text-xs",children:E[s.type]||"N/A"}),e.jsx(h,{variant:"secondary",className:"text-xs",children:s.booking?.code||"-"})]})]}),s.request&&s.request.trim()!==""&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx(g,{className:"h-5 w-5 text-orange-500"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400",children:"Sá»‘ Ä‘iá»‡n thoáº¡i"}),e.jsx("p",{className:"font-mono",children:s.phone||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400",children:"CCCD"}),e.jsx("p",{children:s.cccd||"-"})]})]}),s.request&&s.request.trim()!==""&&e.jsxs("div",{className:"bg-orange-50 p-2 rounded text-sm text-orange-800 border border-orange-100",children:[e.jsx("p",{className:"text-xs font-bold mb-1",children:"YÃªu cáº§u Ä‘áº·c biá»‡t:"}),s.request]})]},s.id))})]})})]})]}),e.jsx(L,{value:"checkin",className:"space-y-4",children:e.jsxs(b,{children:[e.jsxs(D,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5"}),"Check-in theo Ä‘iá»ƒm Ä‘áº¿n"]}),e.jsx(Z,{children:"Äiá»ƒm danh khÃ¡ch hÃ ng táº¡i má»—i Ä‘iá»ƒm Ä‘áº¿n"})]}),e.jsxs(J,{open:H,onOpenChange:s=>{$(s),s||(v([]),u({}),c.reset())},children:[e.jsx(Q,{asChild:!0,children:e.jsxs(r,{className:"gap-2",children:[e.jsx(ne,{className:"h-4 w-4"}),"Táº¡o Ä‘á»£t check-in"]})}),e.jsxs(_,{className:"max-w-[95vw] sm:max-w-7xl max-h-[100vh] flex flex-col",children:[e.jsxs(ee,{children:[e.jsx(se,{children:"Táº¡o Ä‘á»£t check-in má»›i"}),e.jsx(Ee,{children:"Nháº­p tÃªn Ä‘iá»ƒm Ä‘áº¿n, thá»i gian check-in vÃ  Ä‘iá»ƒm danh khÃ¡ch hÃ ng"})]}),e.jsxs("form",{onSubmit:fe,className:"flex flex-col flex-1 overflow-hidden",children:[e.jsx(De,{className:"flex-1 -mr-4 pr-4",children:e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-4 border-b pb-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"TÃªn Ä‘iá»ƒm Ä‘áº¿n *"}),e.jsx(N,{placeholder:"VD: BÃ£i biá»ƒn Má»¹ KhÃª",value:c.data.title,onChange:s=>c.setData("title",s.target.value)}),c.errors.title&&e.jsx("p",{className:"text-sm text-red-500",children:c.errors.title})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Thá»i gian check-in *"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative flex-1 w-full",children:[e.jsx(N,{type:"date",value:c.data.checkin_time?c.data.checkin_time.split("T")[0]:"",onChange:s=>{const t=s.target.value,i=c.data.checkin_time&&c.data.checkin_time.split("T")[1]||"08:00";t&&V(`${t}T${i}`)},className:"pl-10 h-10 w-full"}),e.jsx(Ve,{className:"absolute left-3 top-3 h-4 w-4 text-gray-500"})]}),e.jsxs("div",{className:"relative w-full sm:w-40",children:[e.jsx(N,{type:"time",value:c.data.checkin_time&&c.data.checkin_time.split("T")[1]?.slice(0,5)||"08:00",onChange:s=>{const t=s.target.value,i=c.data.checkin_time?c.data.checkin_time.split("T")[0]:new Date().toISOString().split("T")[0];i&&t&&V(`${i}T${t}`)},className:"pl-10 h-10 w-full"}),e.jsx(I,{className:"absolute left-3 top-3 h-4 w-4 text-gray-500"})]})]}),c.errors.checkin_time&&e.jsx("p",{className:"text-sm text-red-500",children:c.errors.checkin_time})]})]}),me?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"Äang táº£i danh sÃ¡ch khÃ¡ch hÃ ng..."})}):p.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(C,{className:"text-base font-semibold",children:"Äiá»ƒm danh khÃ¡ch hÃ ng"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(r,{type:"button",variant:"outline",size:"sm",className:"flex-1 whitespace-nowrap min-w-[120px]",onClick:()=>{const s={};p.forEach(t=>{s[t.id]={is_present:!0,notes:x[t.id]?.notes||""}}),u(s)},children:[e.jsx(B,{className:"h-4 w-4 mr-1"}),"Táº¥t cáº£ cÃ³ máº·t"]}),e.jsxs(r,{type:"button",variant:"outline",size:"sm",className:"flex-1 whitespace-nowrap min-w-[120px]",onClick:()=>{const s={};p.forEach(t=>{s[t.id]={is_present:!1,notes:x[t.id]?.notes||""}}),u(s)},children:[e.jsx(de,{className:"h-4 w-4 mr-1"}),"Bá» chá»n táº¥t cáº£"]})]})]}),e.jsx("div",{className:"space-y-2",children:Object.entries(M).map(([s,t])=>{const i=t[0]?.booking,f=je.has(s),ye=t.filter(a=>x[a.id]?.is_present).length;return e.jsx(Te,{open:f,onOpenChange:()=>pe(s),children:e.jsxs("div",{className:"border rounded-lg",children:[e.jsx(Se,{className:"w-full",children:e.jsxs("div",{className:"flex items-start gap-3 p-3 hover:bg-muted/50 transition-colors text-left",children:[e.jsx("div",{className:"pt-1 flex-shrink-0",children:f?e.jsx(Fe,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(qe,{className:"h-4 w-4 text-muted-foreground"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-1",children:[e.jsx(h,{variant:"secondary",className:"font-medium",children:s}),i?.status===0&&e.jsx(h,{variant:"outline",className:"bg-yellow-50 text-yellow-700 border-yellow-200 whitespace-nowrap",children:"Chá» xÃ¡c nháº­n"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["(",t.length," khÃ¡ch)"]}),f&&e.jsxs("span",{className:"whitespace-nowrap",children:["â€¢ ",ye,"/",t.length," cÃ³ máº·t"]})]})]})]})}),e.jsx(Le,{children:e.jsxs("div",{className:"border-t",children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(ae,{children:[e.jsx(ce,{children:e.jsxs(S,{children:[e.jsx(n,{className:"w-[60px]",children:"CÃ³ máº·t"}),e.jsx(n,{children:"#"}),e.jsx(n,{children:"Há» tÃªn"}),e.jsx(n,{children:"SÄT"}),e.jsx(n,{children:"CCCD"}),e.jsx(n,{children:"Loáº¡i"}),e.jsx(n,{children:"YÃªu cáº§u Ä‘áº·c biá»‡t"}),e.jsx(n,{children:"Ghi chÃº"})]})}),e.jsx(le,{children:t.map((a,P)=>e.jsxs(S,{className:x[a.id]?.is_present?"bg-green-50":"",children:[e.jsx(d,{children:e.jsx(ie,{checked:x[a.id]?.is_present||!1,onCheckedChange:()=>R(a.id)})}),e.jsx(d,{children:P+1}),e.jsx(d,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[x[a.id]?.is_present?e.jsx(B,{className:"h-4 w-4 text-green-500"}):e.jsx(de,{className:"h-4 w-4 text-red-400"}),a.fullname]})}),e.jsx(d,{className:"font-mono text-sm",children:a.phone||"-"}),e.jsx(d,{children:a.cccd||"-"}),e.jsx(d,{children:e.jsx(h,{variant:"outline",children:E[a.type]||"N/A"})}),e.jsx(d,{className:"max-w-[150px]",children:a.request&&a.request.trim()!==""?e.jsxs("div",{className:"space-y-1",children:[e.jsxs(h,{variant:"outline",className:"bg-orange-50 text-orange-800 border-orange-300 text-xs",children:[e.jsx(g,{className:"h-3 w-3 mr-1"}),"CÃ³ yÃªu cáº§u"]}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",title:a.request,children:a.request})]}):e.jsx("span",{className:"text-muted-foreground text-sm",children:"-"})}),e.jsx(d,{children:e.jsx(N,{placeholder:"Ghi chÃº...",className:"h-8 w-full min-w-[150px]",value:x[a.id]?.notes||"",onChange:z=>X(a.id,z.target.value)})})]},a.id))})]})}),e.jsx("div",{className:"md:hidden space-y-2 p-3",children:t.map((a,P)=>e.jsx("div",{className:`border rounded-lg p-3 ${x[a.id]?.is_present?"bg-green-50 border-green-200":"bg-white"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"pt-1",children:e.jsx(ie,{checked:x[a.id]?.is_present||!1,onCheckedChange:()=>R(a.id),className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"font-medium",children:a.fullname}),e.jsx(h,{variant:"outline",className:"text-xs",children:E[a.type]||"N/A"})]}),(a.phone||a.cccd)&&e.jsxs("div",{className:"text-xs text-gray-500 grid grid-cols-2 gap-2",children:[a.phone&&e.jsxs("div",{children:["SÄT: ",e.jsx("span",{className:"font-mono",children:a.phone})]}),a.cccd&&e.jsxs("div",{children:["CCCD: ",a.cccd]})]}),a.request&&a.request.trim()!==""&&e.jsxs("div",{className:"bg-orange-50 p-2 rounded text-xs text-orange-800 border border-orange-100 flex gap-2 items-center",children:[e.jsx(g,{className:"h-3 w-3 flex-shrink-0"}),e.jsx("span",{children:a.request})]}),e.jsx(N,{placeholder:"Ghi chÃº (náº¿u cÃ³)...",className:"h-8 w-full text-sm",value:x[a.id]?.notes||"",onChange:z=>X(a.id,z.target.value)})]})]})},a.id))})]})})]})},s)})})]}):c.data.checkin_time?e.jsx("div",{className:"text-center py-8 border rounded-lg",children:e.jsx("p",{className:"text-muted-foreground",children:"KhÃ´ng cÃ³ khÃ¡ch hÃ ng nÃ o cho ngÃ y nÃ y"})}):null]})}),e.jsxs(te,{className:"mt-4 pt-4 border-t",children:[e.jsx(r,{type:"button",variant:"outline",onClick:()=>{$(!1),v([]),u({}),c.reset()},children:"Há»§y"}),e.jsxs(r,{type:"submit",disabled:c.processing||!c.data.title||!c.data.checkin_time,className:"gap-2",children:[e.jsx(Ie,{className:"h-4 w-4"}),c.processing?"Äang lÆ°u...":"LÆ°u check-in"]})]})]})]})]})]}),e.jsx(y,{children:l.trip_check_ins.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"ChÆ°a cÃ³ Ä‘á»£t check-in nÃ o"}):e.jsx("div",{className:"space-y-3",children:l.trip_check_ins.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium flex items-center gap-2",children:[e.jsx(Oe,{className:"h-4 w-4 text-primary"}),s.title]}),e.jsxs("div",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[e.jsx(I,{className:"h-3 w-3"}),new Date(s.checkin_time).toLocaleString("vi-VN")]}),e.jsx("div",{className:"text-sm mt-1",children:e.jsxs(h,{variant:"outline",children:[s.check_in_details.filter(t=>t.is_present).length,"/",j.length," cÃ³ máº·t"]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{href:W.checkin.show(s.id),children:e.jsxs(r,{variant:"outline",size:"sm",className:"gap-1",children:[e.jsx(Ke,{className:"h-4 w-4"}),"Äiá»ƒm danh"]})}),e.jsx(r,{variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-700",onClick:()=>ge(s.id),children:e.jsx(oe,{className:"h-4 w-4"})})]})]},s.id))})})]})}),e.jsx(L,{value:"notes",className:"space-y-4",children:e.jsxs(b,{children:[e.jsxs(D,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-5 w-5"}),"Nháº­t kÃ½ chuyáº¿n Ä‘i"]}),e.jsx(Z,{children:"Ghi chÃ©p trong quÃ¡ trÃ¬nh dáº«n tour"})]}),e.jsxs(J,{open:xe,onOpenChange:A,children:[e.jsx(Q,{asChild:!0,children:e.jsxs(r,{className:"gap-2",children:[e.jsx(ne,{className:"h-4 w-4"}),"Viáº¿t nháº­t kÃ½"]})}),e.jsxs(_,{children:[e.jsx(ee,{children:e.jsx(se,{children:"Viáº¿t nháº­t kÃ½ má»›i"})}),e.jsxs("form",{onSubmit:Ne,children:[e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"TiÃªu Ä‘á» *"}),e.jsx(N,{placeholder:"VD: NgÃ y 1 - Äáº¿n ÄÃ  Náºµng",value:m.data.title,onChange:s=>m.setData("title",s.target.value)}),m.errors.title&&e.jsx("p",{className:"text-sm text-red-500",children:m.errors.title})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Ná»™i dung *"}),e.jsx(Be,{placeholder:"Ghi chÃ©p cá»§a báº¡n...",rows:5,value:m.data.content,onChange:s=>m.setData("content",s.target.value)}),m.errors.content&&e.jsx("p",{className:"text-sm text-red-500",children:m.errors.content})]})]}),e.jsxs(te,{children:[e.jsx(r,{type:"button",variant:"outline",onClick:()=>A(!1),children:"Há»§y"}),e.jsx(r,{type:"submit",disabled:m.processing,children:"LÆ°u"})]})]})]})]})]}),e.jsx(y,{children:l.trip_notes.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"ChÆ°a cÃ³ nháº­t kÃ½ nÃ o"}):e.jsx("div",{className:"space-y-4",children:l.trip_notes.map(s=>e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(s.created_at).toLocaleString("vi-VN")})]}),e.jsx(r,{variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-700",onClick:()=>ve(s.id),children:e.jsx(oe,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"mt-2 text-sm whitespace-pre-wrap",children:s.content})]},s.id))})})]})})]})]})]})}export{$s as default};
