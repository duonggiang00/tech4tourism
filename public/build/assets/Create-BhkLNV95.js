import{c as jt,b as bt,r as et,u as vt,j as t,a as xt,H as St}from"./app-Bzh0QcV-.js";import{B as Ce}from"./button-DLyenbHO.js";import{C as dt,a as mt,c as ht,b as ft}from"./card-DwG3PsBo.js";import{C as Ct}from"./checkbox-CbbR_BTG.js";import{I as pt}from"./input-BI3Hn33c.js";import{L as we}from"./label-CaT48Pgd.js";import{d as wt,S as Tt,a as Dt,b as kt,c as Ze}from"./select-BE8zau-p.js";import{D as Vt,a as $t,e as Ft,c as Et,b as Mt,d as Ht}from"./dialog-60B12crD.js";import{A as Bt}from"./app-layout-CMbpVfDp.js";import{t as ut}from"./index-7ujUmCNw.js";import{t as Lt}from"./index-rXl9eqvF.js";import{f as _t,C as Pt,v as It}from"./vi-vDRzmdPg.js";import{P as At,a as Ot,b as Gt}from"./popover-DvnMj0Ab.js";import{c as Rt}from"./utils-D0Zg16Wk.js";import{A as Ut}from"./arrow-left-DcITzwxY.js";import{C as Kt,U as Qt}from"./users-C6EN8SYz.js";import{C as Yt}from"./clock-Be8x_k56.js";import"./app-AjfTabGW.js";import"./index-Cs37kpNU.js";import"./index-DXbMLhRD.js";import"./index-BksToH6P.js";import"./createLucideIcon-Qg7y1Ni9.js";import"./index-3aTD3_kd.js";import"./x-Cc7sq3My.js";import"./avatar-DMx0EJxa.js";import"./index-Dhq0cQs_.js";import"./index-CMWG4mbA.js";import"./index-D9s5CDJa.js";import"./app-logo-icon-Cbb-6XH_.js";import"./index-31lGrPGR.js";import"./index-gSLmiL6w.js";import"./index-DaohGxKX.js";import"./index-2FGh3n-F.js";import"./index-CGelz8kl.js";import"./file-text-B2N7Qcbe.js";import"./badge-GiRAufZZ.js";const gt=Te=>{const e=jt.c(12),{value:l,onChange:f,placeholder:De,id:n}=Te,[S,u]=et.useState(!1);let c;e[0]!==S||e[1]!==l?(c=S?l:l?Number(l).toLocaleString("vi-VN"):"",e[0]=S,e[1]=l,e[2]=c):c=e[2];const ke=c;let o;e[3]!==f?(o=s=>{const a=s.target.value.replace(/\D/g,"");f(a)},e[3]=f,e[4]=o):o=e[4];let d,m;e[5]===Symbol.for("react.memo_cache_sentinel")?(d=()=>u(!0),m=()=>u(!1),e[5]=d,e[6]=m):(d=e[5],m=e[6]);let h;return e[7]!==ke||e[8]!==n||e[9]!==De||e[10]!==o?(h=t.jsx(pt,{id:n,type:"text",value:ke,onChange:o,onFocus:d,onBlur:m,placeholder:De}),e[7]=ke,e[8]=n,e[9]=De,e[10]=o,e[11]=h):h=e[11],h};function Es(Te){const e=jt.c(213),{template:l,guides:f}=Te,{props:De}=bt(),n=De.flash,[S,u]=et.useState(!1),[c,ke]=et.useState("08:00");let o;e[0]!==l.price_adult?(o=l.price_adult?Math.round(Number(l.price_adult)):"",e[0]=l.price_adult,e[1]=o):o=e[1];let d;e[2]!==l.price_children?(d=l.price_children?Math.round(Number(l.price_children)):"",e[2]=l.price_children,e[3]=d):d=e[3];let m;e[4]===Symbol.for("react.memo_cache_sentinel")?(m=[],e[4]=m):m=e[4];let h;e[5]!==o||e[6]!==d?(h={date_start:"",limit:"20",price_adult:o,price_children:d,status:"1",guide_ids:m},e[5]=o,e[6]=d,e[7]=h):h=e[7];const{data:s,setData:a,post:tt,processing:$e,errors:r}=vt(h);let Fe;e[8]!==n.success_instance_id?(Fe=()=>{n?.success_instance_id&&u(!0)},e[8]=n.success_instance_id,e[9]=Fe):Fe=e[9];let Ee;e[10]!==n?(Ee=[n],e[10]=n,e[11]=Ee):Ee=e[11],et.useEffect(Fe,Ee);let Me;e[12]!==n.success_instance_id?(Me=()=>{u(!1),xt.visit(`/booking/create?tour_instance_id=${n.success_instance_id}`)},e[12]=n.success_instance_id,e[13]=Me):Me=e[13];const st=Me;let He;e[14]!==l.id?(He=()=>{u(!1),xt.visit(ut.show(l.id).url)},e[14]=l.id,e[15]=He):He=e[15];const lt=He;let Be;e[16]!==tt||e[17]!==l.id?(Be=i=>{i.preventDefault(),tt(`/tours/${l.id}/instances`,{preserveScroll:!0,onSuccess:de=>{de.props.flash?.success_instance_id&&u(!0)},onError:Jt})},e[16]=tt,e[17]=l.id,e[18]=Be):Be=e[18];const it=Be;let Le;e[19]!==s.guide_ids||e[20]!==a?(Le=i=>{a("guide_ids",s.guide_ids.includes(i)?s.guide_ids.filter(de=>de!==i):[...s.guide_ids,i])},e[19]=s.guide_ids,e[20]=a,e[21]=Le):Le=e[21];const at=Le;let C,w,T,D,p,x,_,g,k,V,j,$,F,y,E,N,M,b,v;if(e[22]!==s.date_start||e[23]!==r.date_start||e[24]!==it||e[25]!==a||e[26]!==l.day||e[27]!==l.id||e[28]!==l.night||e[29]!==l.title||e[30]!==c){const i=s.date_start?new Date(s.date_start):null,de=i&&!isNaN(i.getTime())?new Date(i.getTime()+(l.day-1)*24*60*60*1e3).toISOString().split("T")[0]:"";T=Bt;let Ve;e[50]===Symbol.for("react.memo_cache_sentinel")?(Ve={title:"Danh sách Tour",href:ut.index().url},e[50]=Ve):Ve=e[50];const yt=l.title;let me;e[51]!==l.id?(me=ut.show(l.id),e[51]=l.id,e[52]=me):me=e[52];let he;e[53]!==me.url||e[54]!==l.title?(he={title:yt,href:me.url},e[53]=me.url,e[54]=l.title,e[55]=he):he=e[55];let qe;e[56]===Symbol.for("react.memo_cache_sentinel")?(qe={title:"Tạo Chuyến Đi Mới",href:"#"},e[56]=qe):qe=e[56],e[57]!==he?(b=[Ve,he,qe],e[57]=he,e[58]=b):b=e[58];const nt=`Tạo chuyến đi: ${l.title}`;e[59]!==nt?(v=t.jsx(St,{title:nt}),e[59]=nt,e[60]=v):v=e[60],M="min-h-screen bg-gray-50/50 py-8",E="mx-auto max-w-4xl px-4",e[61]===Symbol.for("react.memo_cache_sentinel")?(N=t.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[t.jsxs(Ce,{variant:"ghost",onClick:zt,className:"pl-0 hover:bg-transparent hover:text-blue-600",children:[t.jsx(Ut,{className:"mr-2 h-4 w-4"}),"Quay lại"]}),t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Tạo Chuyến Đi Mới"})]}),e[61]=N):N=e[61],$=it,F="space-y-6";let fe;e[62]!==l.title?(fe=t.jsx(dt,{children:t.jsxs(mt,{className:"text-blue-700",children:["Tour Template: ",l.title]})}),e[62]=l.title,e[63]=fe):fe=e[63];let ze;e[64]===Symbol.for("react.memo_cache_sentinel")?(ze=t.jsx("span",{className:"font-medium text-gray-600",children:"Thời gian:"}),e[64]=ze):ze=e[64];let ue;e[65]!==l.day||e[66]!==l.night?(ue=t.jsx(ht,{children:t.jsx("div",{className:"grid grid-cols-2 gap-4 text-sm",children:t.jsxs("div",{children:[ze," ",l.day," ngày ",l.night," đêm"]})})}),e[65]=l.day,e[66]=l.night,e[67]=ue):ue=e[67],e[68]!==fe||e[69]!==ue?(y=t.jsxs(ft,{className:"border-blue-100 bg-blue-50/50",children:[fe,ue]}),e[68]=fe,e[69]=ue,e[70]=y):y=e[70],w=ft,e[71]===Symbol.for("react.memo_cache_sentinel")?(j=t.jsx(dt,{children:t.jsx(mt,{children:"Thông tin Chuyến Đi"})}),e[71]=j):j=e[71],C=ht,V="space-y-6",D="space-y-2",e[72]===Symbol.for("react.memo_cache_sentinel")?(p=t.jsxs(we,{htmlFor:"date_start",children:["Ngày khởi hành"," ",t.jsx("span",{className:"text-red-500",children:"*"})]}),e[72]=p):p=e[72];const ct=!s.date_start&&"text-muted-foreground";let pe;e[73]!==ct?(pe=Rt("w-full justify-start text-left font-normal",ct),e[73]=ct,e[74]=pe):pe=e[74];let Je;e[75]===Symbol.for("react.memo_cache_sentinel")?(Je=t.jsx(Kt,{className:"mr-2 h-4 w-4"}),e[75]=Je):Je=e[75];let xe;e[76]!==s.date_start?(xe=s.date_start&&!isNaN(new Date(s.date_start).getTime())?_t(new Date(s.date_start),"dd/MM/yyyy"):t.jsx("span",{children:"Chọn ngày"}),e[76]=s.date_start,e[77]=xe):xe=e[77];let _e;e[78]!==pe||e[79]!==xe?(_e=t.jsx(At,{asChild:!0,children:t.jsxs(Ce,{variant:"outline",className:pe,children:[Je,xe]})}),e[78]=pe,e[79]=xe,e[80]=_e):_e=e[80];let ge;e[81]!==s.date_start?(ge=s.date_start?new Date(new Date(s.date_start).setHours(0,0,0,0)):void 0,e[81]=s.date_start,e[82]=ge):ge=e[82];let je;e[83]!==a||e[84]!==c?(je=Se=>{if(Se){const Xe=Se.getFullYear(),ot=String(Se.getMonth()+1).padStart(2,"0"),Nt=String(Se.getDate()).padStart(2,"0");a("date_start",`${Xe}-${ot}-${Nt} ${c}`)}else a("date_start","")},e[83]=a,e[84]=c,e[85]=je):je=e[85];let ye;e[86]!==ge||e[87]!==je?(ye=t.jsx(Ot,{className:"w-auto p-0",align:"start",children:t.jsx(Pt,{mode:"single",selected:ge,onSelect:je,initialFocus:!0})}),e[86]=ge,e[87]=je,e[88]=ye):ye=e[88];let Ne;e[89]!==_e||e[90]!==ye?(Ne=t.jsx("div",{className:"flex-1",children:t.jsxs(Gt,{children:[_e,ye]})}),e[89]=_e,e[90]=ye,e[91]=Ne):Ne=e[91];let We;e[92]===Symbol.for("react.memo_cache_sentinel")?(We=t.jsx(Yt,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e[92]=We):We=e[92];let be;e[93]!==s.date_start||e[94]!==a?(be=Se=>{const Xe=Se.target.value;if(ke(Xe),s.date_start){const ot=s.date_start.split(" ")[0].split("T")[0];a("date_start",`${ot} ${Xe}`)}},e[93]=s.date_start,e[94]=a,e[95]=be):be=e[95];let ve;e[96]!==be||e[97]!==c?(ve=t.jsx("div",{className:"w-[120px]",children:t.jsxs("div",{className:"relative",children:[We,t.jsx(pt,{type:"time",value:c,onChange:be,className:"pl-9"})]})}),e[96]=be,e[97]=c,e[98]=ve):ve=e[98],e[99]!==Ne||e[100]!==ve?(x=t.jsxs("div",{className:"flex gap-2",children:[Ne,ve]}),e[99]=Ne,e[100]=ve,e[101]=x):x=e[101],e[102]!==r.date_start?(_=r.date_start&&t.jsx("p",{className:"text-sm text-red-500",children:r.date_start}),e[102]=r.date_start,e[103]=_):_=e[103],e[104]!==s.date_start?(g=s.date_start&&!isNaN(new Date(s.date_start).getTime())&&t.jsxs("p",{className:"text-sm text-blue-600",children:["Khởi hành: ",t.jsx("span",{className:"font-medium",children:_t(new Date(s.date_start),"HH:mm, EEEE, 'ngày' dd 'tháng' MM 'năm' yyyy",{locale:It})})]}),e[104]=s.date_start,e[105]=g):g=e[105],k=de&&t.jsxs("p",{className:"text-sm text-gray-500",children:["Ngày kết thúc dự kiến:"," ",t.jsx("span",{className:"font-medium",children:new Date(de).toLocaleDateString("vi-VN")})]}),e[22]=s.date_start,e[23]=r.date_start,e[24]=it,e[25]=a,e[26]=l.day,e[27]=l.id,e[28]=l.night,e[29]=l.title,e[30]=c,e[31]=C,e[32]=w,e[33]=T,e[34]=D,e[35]=p,e[36]=x,e[37]=_,e[38]=g,e[39]=k,e[40]=V,e[41]=j,e[42]=$,e[43]=F,e[44]=y,e[45]=E,e[46]=N,e[47]=M,e[48]=b,e[49]=v}else C=e[31],w=e[32],T=e[33],D=e[34],p=e[35],x=e[36],_=e[37],g=e[38],k=e[39],V=e[40],j=e[41],$=e[42],F=e[43],y=e[44],E=e[45],N=e[46],M=e[47],b=e[48],v=e[49];let H;e[106]!==D||e[107]!==p||e[108]!==x||e[109]!==_||e[110]!==g||e[111]!==k?(H=t.jsxs("div",{className:D,children:[p,x,_,g,k]}),e[106]=D,e[107]=p,e[108]=x,e[109]=_,e[110]=g,e[111]=k,e[112]=H):H=e[112];let Pe;e[113]===Symbol.for("react.memo_cache_sentinel")?(Pe=t.jsx(we,{htmlFor:"limit",children:"Số chỗ tối đa (để trống = không giới hạn)"}),e[113]=Pe):Pe=e[113];let B;e[114]!==a?(B=i=>a("limit",i.target.value),e[114]=a,e[115]=B):B=e[115];let L;e[116]!==s.limit||e[117]!==B?(L=t.jsx(pt,{id:"limit",type:"number",min:"1",value:s.limit,onChange:B,placeholder:"Ví dụ: 30",className:"max-w-xs"}),e[116]=s.limit,e[117]=B,e[118]=L):L=e[118];let P;e[119]!==r.limit?(P=r.limit&&t.jsx("p",{className:"text-sm text-red-500",children:r.limit}),e[119]=r.limit,e[120]=P):P=e[120];let I;e[121]!==L||e[122]!==P?(I=t.jsxs("div",{className:"space-y-2",children:[Pe,L,P]}),e[121]=L,e[122]=P,e[123]=I):I=e[123];let Ie;e[124]===Symbol.for("react.memo_cache_sentinel")?(Ie=t.jsx(we,{htmlFor:"price_adult",children:"Giá người lớn (VNĐ)"}),e[124]=Ie):Ie=e[124];let A;e[125]!==a?(A=i=>a("price_adult",i),e[125]=a,e[126]=A):A=e[126];let O;e[127]!==s.price_adult||e[128]!==A?(O=t.jsx(gt,{id:"price_adult",value:s.price_adult,onChange:A,placeholder:"Ví dụ: 5000000"}),e[127]=s.price_adult,e[128]=A,e[129]=O):O=e[129];let G;e[130]!==r.price_adult?(G=r.price_adult&&t.jsx("p",{className:"text-sm text-red-500",children:r.price_adult}),e[130]=r.price_adult,e[131]=G):G=e[131];let R;e[132]!==O||e[133]!==G?(R=t.jsxs("div",{className:"space-y-2",children:[Ie,O,G]}),e[132]=O,e[133]=G,e[134]=R):R=e[134];let Ae;e[135]===Symbol.for("react.memo_cache_sentinel")?(Ae=t.jsx(we,{htmlFor:"price_children",children:"Giá trẻ em (VNĐ)"}),e[135]=Ae):Ae=e[135];let U;e[136]!==a?(U=i=>a("price_children",i),e[136]=a,e[137]=U):U=e[137];let K;e[138]!==s.price_children||e[139]!==U?(K=t.jsx(gt,{id:"price_children",value:s.price_children,onChange:U,placeholder:"Ví dụ: 3000000"}),e[138]=s.price_children,e[139]=U,e[140]=K):K=e[140];let Q;e[141]!==r.price_children?(Q=r.price_children&&t.jsx("p",{className:"text-sm text-red-500",children:r.price_children}),e[141]=r.price_children,e[142]=Q):Q=e[142];let Y;e[143]!==K||e[144]!==Q?(Y=t.jsxs("div",{className:"space-y-2",children:[Ae,K,Q]}),e[143]=K,e[144]=Q,e[145]=Y):Y=e[145];let q;e[146]!==R||e[147]!==Y?(q=t.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[R,Y]}),e[146]=R,e[147]=Y,e[148]=q):q=e[148];let Oe;e[149]===Symbol.for("react.memo_cache_sentinel")?(Oe=t.jsx(we,{htmlFor:"status",children:"Trạng thái"}),e[149]=Oe):Oe=e[149];let z;e[150]!==a?(z=i=>a("status",i),e[150]=a,e[151]=z):z=e[151];let Ge;e[152]===Symbol.for("react.memo_cache_sentinel")?(Ge=t.jsx(Tt,{className:"max-w-xs",children:t.jsx(Dt,{})}),e[152]=Ge):Ge=e[152];let Re;e[153]===Symbol.for("react.memo_cache_sentinel")?(Re=t.jsxs(kt,{children:[t.jsx(Ze,{value:"0",children:"Đã hủy"}),t.jsx(Ze,{value:"1",children:"Sắp có"}),t.jsx(Ze,{value:"2",children:"Đang diễn ra"}),t.jsx(Ze,{value:"3",children:"Đã hoàn thành"})]}),e[153]=Re):Re=e[153];let J;e[154]!==s.status||e[155]!==z?(J=t.jsxs(wt,{value:s.status,onValueChange:z,children:[Ge,Re]}),e[154]=s.status,e[155]=z,e[156]=J):J=e[156];let W;e[157]!==r.status?(W=r.status&&t.jsx("p",{className:"text-sm text-red-500",children:r.status}),e[157]=r.status,e[158]=W):W=e[158];let X;e[159]!==J||e[160]!==W?(X=t.jsxs("div",{className:"space-y-2",children:[Oe,J,W]}),e[159]=J,e[160]=W,e[161]=X):X=e[161];let Z;e[162]!==C||e[163]!==V||e[164]!==H||e[165]!==I||e[166]!==q||e[167]!==X?(Z=t.jsxs(C,{className:V,children:[H,I,q,X]}),e[162]=C,e[163]=V,e[164]=H,e[165]=I,e[166]=q,e[167]=X,e[168]=Z):Z=e[168];let ee;e[169]!==w||e[170]!==j||e[171]!==Z?(ee=t.jsxs(w,{children:[j,Z]}),e[169]=w,e[170]=j,e[171]=Z,e[172]=ee):ee=e[172];let Ue;e[173]===Symbol.for("react.memo_cache_sentinel")?(Ue=t.jsx(dt,{children:t.jsxs(mt,{className:"flex items-center gap-2",children:[t.jsx(Qt,{className:"h-5 w-5"})," Hướng dẫn viên"]})}),e[173]=Ue):Ue=e[173];let te;e[174]!==s.guide_ids||e[175]!==f||e[176]!==at?(te=t.jsxs(ft,{children:[Ue,t.jsx(ht,{children:f.length===0?t.jsx("p",{className:"text-sm text-gray-500",children:"Chưa có hướng dẫn viên nào trong hệ thống."}):t.jsx("div",{className:"space-y-3",children:f.map(i=>t.jsxs("div",{className:"flex items-center space-x-3 rounded-lg border p-3 hover:bg-gray-50",children:[t.jsx(Ct,{id:`guide-${i.id}`,checked:s.guide_ids.includes(i.id),onCheckedChange:()=>at(i.id),disabled:i.has_active_tour&&!s.guide_ids.includes(i.id)}),t.jsx(we,{htmlFor:`guide-${i.id}`,className:"flex-1 cursor-pointer",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("span",{className:"font-medium",children:i.name}),i.has_active_tour&&!s.guide_ids.includes(i.id)&&t.jsx("span",{className:"ml-2 rounded bg-orange-100 px-1.5 py-0.5 text-xs font-medium text-orange-700",children:"Đã có tour"})]}),t.jsx("span",{className:"text-xs text-gray-500",children:i.email})]})})]},i.id))})})]}),e[174]=s.guide_ids,e[175]=f,e[176]=at,e[177]=te):te=e[177];let Ke;e[178]===Symbol.for("react.memo_cache_sentinel")?(Ke=t.jsx(Ce,{type:"button",variant:"outline",onClick:qt,children:"Hủy bỏ"}),e[178]=Ke):Ke=e[178];const rt=$e?"Đang tạo...":"Tạo Chuyến Đi";let se;e[179]!==$e||e[180]!==rt?(se=t.jsxs("div",{className:"flex justify-end gap-4 border-t pt-6",children:[Ke,t.jsx(Ce,{type:"submit",disabled:$e,className:"min-w-[200px]",children:rt})]}),e[179]=$e,e[180]=rt,e[181]=se):se=e[181];let le;e[182]!==$||e[183]!==F||e[184]!==y||e[185]!==ee||e[186]!==te||e[187]!==se?(le=t.jsxs("form",{onSubmit:$,className:F,children:[y,ee,te,se]}),e[182]=$,e[183]=F,e[184]=y,e[185]=ee,e[186]=te,e[187]=se,e[188]=le):le=e[188];let ie;e[189]!==E||e[190]!==N||e[191]!==le?(ie=t.jsxs("div",{className:E,children:[N,le]}),e[189]=E,e[190]=N,e[191]=le,e[192]=ie):ie=e[192];let Qe;e[193]===Symbol.for("react.memo_cache_sentinel")?(Qe=t.jsxs(Vt,{children:[t.jsx($t,{children:"Tạo chuyến đi thành công!"}),t.jsx(Ft,{children:"Bạn muốn thực hiện thao tác gì tiếp theo với chuyến đi này?"})]}),e[193]=Qe):Qe=e[193];let ae;e[194]!==lt?(ae=t.jsx(Ce,{variant:"outline",onClick:lt,children:"Về trang Tour"}),e[194]=lt,e[195]=ae):ae=e[195];let re;e[196]!==st?(re=t.jsx(Ce,{onClick:st,children:"Tạo Booking ngay"}),e[196]=st,e[197]=re):re=e[197];let ne;e[198]!==ae||e[199]!==re?(ne=t.jsxs(Et,{children:[Qe,t.jsxs(Mt,{className:"flex gap-2 sm:justify-end",children:[ae,re]})]}),e[198]=ae,e[199]=re,e[200]=ne):ne=e[200];let ce;e[201]!==S||e[202]!==ne?(ce=t.jsx(Ht,{open:S,onOpenChange:u,children:ne}),e[201]=S,e[202]=ne,e[203]=ce):ce=e[203];let oe;e[204]!==M||e[205]!==ie||e[206]!==ce?(oe=t.jsxs("div",{className:M,children:[ie,ce]}),e[204]=M,e[205]=ie,e[206]=ce,e[207]=oe):oe=e[207];let Ye;return e[208]!==T||e[209]!==b||e[210]!==v||e[211]!==oe?(Ye=t.jsxs(T,{breadcrumbs:b,children:[v,oe]}),e[208]=T,e[209]=b,e[210]=v,e[211]=oe,e[212]=Ye):Ye=e[212],Ye}function qt(){return window.history.back()}function zt(){return window.history.back()}function Jt(Te){console.error("Errors:",Te),Lt.error("Có lỗi xảy ra khi tạo chuyến đi")}export{Es as default};
