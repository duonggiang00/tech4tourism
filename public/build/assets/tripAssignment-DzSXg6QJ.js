import{r as a,j as s,d as N}from"./app-jK4qC5mS.js";import{B as u}from"./button-CbjqQSYC.js";import{d as k,c as I,D as L,a as V,b as T}from"./dialog-vZSf95IW.js";import{L as j}from"./label-D5rypICj.js";import{d as p,S as v,a as f,b as S,c as i}from"./select-ykbT3YN1.js";import{t as l}from"./index-DP83cKko.js";import"./app-B32Q6Rc9.js";import"./utils-D0Zg16Wk.js";import"./index-DrepN1D_.js";import"./index-BY1UvJ8l.js";import"./x-CqTXyibP.js";import"./createLucideIcon-Dv7VkWmT.js";import"./index-CD0XU3oY.js";import"./index-B4_oT4wZ.js";function J({open:y,onOpenChange:t,tourId:C,allUsers:d,currentAssignments:o,onSuccess:D}){const[r,c]=a.useState(""),[h,b]=a.useState("1"),[m,x]=a.useState(!1),g=a.useMemo(()=>{const e=o.map(n=>n.user_id);return d.filter(n=>!e.includes(n.id)&&!n.has_active_tour)},[d,o]),H=async()=>{if(!r){l.error("Vui lòng chọn hướng dẫn viên.");return}x(!0);try{await N.post(`/tours/${C}/assignments`,{user_id:r,status:h}),l.success("Đã thêm hướng dẫn viên!"),D(),t(!1),c("")}catch{l.error("Có lỗi xảy ra khi thêm hướng dẫn viên.")}finally{x(!1)}};return s.jsx(k,{open:y,onOpenChange:t,children:s.jsxs(I,{className:"sm:max-w-[425px]",children:[s.jsx(L,{children:s.jsx(V,{children:"Phân công Hướng dẫn viên"})}),s.jsxs("div",{className:"grid gap-4 py-4",children:[s.jsxs("div",{className:"grid gap-2",children:[s.jsx(j,{children:"Chọn Hướng dẫn viên"}),s.jsxs(p,{onValueChange:c,value:r,children:[s.jsx(v,{children:s.jsx(f,{placeholder:"Chọn nhân viên..."})}),s.jsx(S,{children:g.length>0?g.map(e=>s.jsxs(i,{value:String(e.id),children:[e.name," (",e.email,")"]},e.id)):s.jsx("div",{className:"p-2 text-center text-sm text-gray-500",children:"Hết nhân viên khả dụng."})})]})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(j,{children:"Trạng thái"}),s.jsxs(p,{onValueChange:b,value:h,children:[s.jsx(v,{children:s.jsx(f,{})}),s.jsxs(S,{children:[s.jsx(i,{value:"0",children:"Chờ xác nhận"}),s.jsx(i,{value:"1",children:"Đang hoạt động"}),s.jsx(i,{value:"2",children:"Hoàn thành"}),s.jsx(i,{value:"3",children:"Đã hủy"})]})]})]})]}),s.jsxs(T,{children:[s.jsx(u,{variant:"outline",onClick:()=>t(!1),children:"Hủy"}),s.jsx(u,{onClick:H,disabled:m,children:m?"Đang lưu...":"Lưu"})]})]})})}export{J as GuideAssignmentDialog};
