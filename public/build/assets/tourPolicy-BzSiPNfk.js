import{r as h,j as s,d as x}from"./app-CQY01_Hl.js";import{B as f}from"./button-BluykqL-.js";import{d as S,c as b,D,a as C,b as _}from"./dialog-BkFPLtOE.js";import{L as v}from"./label-EGOmbW92.js";import{d as N,S as L,a as w,b as E,c as V}from"./select-BC9YTAFF.js";import{t as r}from"./index-Du1opkJh.js";import"./app-CEC-CZWY.js";import"./utils-D0Zg16Wk.js";import"./index-BZBSjhWP.js";import"./index-Cx_4zReh.js";import"./x-C5aSEyQM.js";import"./createLucideIcon-DRgLANJZ.js";import"./index-DK901XDU.js";import"./index-B4_eF53t.js";function Q({open:a,onOpenChange:c,tourId:d,availablePolicies:m=[],editingTourPolicy:t,onSuccess:j}){const[p,u]=h.useState(!1),[o,l]=h.useState({policy_id:""});h.useEffect(()=>{a&&l(t?{policy_id:String(t.policy_id)}:{policy_id:""})},[a,t]);const y=e=>{m.find(n=>n.id===Number(e))&&l({policy_id:e})},g=async e=>{if(e.preventDefault(),!o.policy_id)return r.error("Vui lòng chọn chính sách");u(!0);try{const i={policy_id:Number(o.policy_id)};t?(await x.put(`tours/${d}/tourpolicies/${t.id}`,i),r.success("Cập nhật chính sách thành công")):(await x.post(`/tours/${d}/tourpolicies`,i),r.success("Thêm chính sách thành công")),j?.(),c(!1)}catch(i){console.error(i);const n=i.response?.data?.message||"Có lỗi xảy ra";r.error(n)}finally{u(!1)}};return s.jsx(S,{open:a,onOpenChange:c,children:s.jsxs(b,{className:"max-h-[90vh] max-w-lg overflow-y-auto",children:[s.jsx(D,{children:s.jsx(C,{children:t?"Cập nhật chính sách":"Thêm chính sách cho Tour"})}),s.jsxs("form",{onSubmit:g,className:"space-y-4 py-2",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs(v,{children:["Loại chính sách"," ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs(N,{value:o.policy_id,onValueChange:y,children:[s.jsx(L,{children:s.jsx(w,{placeholder:"-- Chọn chính sách --"})}),s.jsx(E,{children:m.map(e=>s.jsx(V,{value:String(e.id),children:e.title},e.id))})]})]}),s.jsxs(_,{children:[s.jsx(f,{type:"button",variant:"outline",onClick:()=>c(!1),disabled:p,children:"Hủy"}),s.jsx(f,{type:"submit",disabled:p,children:"Lưu lại"})]})]})]})})}export{Q as TourPolicyDialog};
