import{c as lt,r as ye,u as Me,j as t,L as $,a as Ee,H as at}from"./app-CaSGj1uT.js";import{A as Oe,a as $e,b as Re}from"./alert-C3D_2O1P.js";import{A as rt,a as it,b as nt,c as ct,d as ot,e as mt,f as dt,g as ht}from"./alert-dialog-3dnkhgu_.js";import{B as Ue}from"./badge-fjcL5lAh.js";import{B as i}from"./button-BZEXzofL.js";import{D as xt,a as ut,b as ft,c as gt,d as jt}from"./dialog-C6DnRKYe.js";import{I as pt}from"./input-DS6fKu5u.js";import{L as bt}from"./label-D5A-ek0L.js";import{S as qe,a as Qe,b as Ge,c as n,d as Je}from"./select-BLjx6kkv.js";import{T as yt,a as vt,b as We,c as M,d as Nt,e as O}from"./table-CmhPySl3.js";import{b as m,A as St}from"./app-layout-Cy2scFGy.js";import{C as wt}from"./circle-check-D6S4rrRZ.js";import{C as Ct}from"./circle-x-B9zG9rAW.js";import{P as Tt}from"./plus-Cuh-3za3.js";import{E as Ye}from"./eye-DB6MKcxJ.js";import{P as Ze}from"./pencil-CgkILQjS.js";import{T as et}from"./trash-2-7ovCRB6M.js";import"./app-C1CjLIM7.js";import"./utils-D0Zg16Wk.js";import"./index-P0NC3ElT.js";import"./index-Dc8D3YAC.js";import"./x-BJwh83_V.js";import"./createLucideIcon-B2IF2C91.js";import"./index-B35KFXzL.js";import"./index-5xdvLrBf.js";import"./avatar-y1YlfNVC.js";import"./index-Dhq0cQs_.js";import"./index-CMWG4mbA.js";import"./index-D9s5CDJa.js";import"./index-7ujUmCNw.js";import"./app-logo-icon-2KxTv0kJ.js";import"./index-31lGrPGR.js";import"./index-gSLmiL6w.js";import"./index-DaohGxKX.js";import"./index-2FGh3n-F.js";import"./index-CGelz8kl.js";import"./users-BVM233CZ.js";import"./file-text-xLwrV0oL.js";import"./index-D9FVAaNM.js";const ve={0:{label:"Chờ xử lý",color:"bg-yellow-500"},1:{label:"Đã xác nhận",color:"bg-green-500"},2:{label:"Đã hủy",color:"bg-red-500"},3:{label:"Hoàn thành",color:"bg-blue-500"}},Dt=[{title:"Quản lý Bookings",href:"/admin/bookings"}];function js(a){const e=lt.c(116),{bookings:l,filters:R,flash:c}=a;let U;e[0]!==R?(U=R===void 0?{}:R,e[0]=R,e[1]=U):U=e[1];const ze=U,[d,q]=ye.useState(null),[h,Q]=ye.useState(null),[r,Pe]=ye.useState(ze.search||""),[o,Ve]=ye.useState(ze.status??null);let G;e[2]===Symbol.for("react.memo_cache_sentinel")?(G={status:0},e[2]=G):G=e[2];const{data:tt,setData:x,put:Ne,processing:J,reset:Se,errors:W}=Me(G),{delete:we,processing:Y}=Me();let Z;e[3]!==x?(Z=s=>{q(s),x({status:s.status})},e[3]=x,e[4]=Z):Z=e[4];const u=Z;let ee;e[5]!==d||e[6]!==Ne||e[7]!==Se?(ee=s=>{s.preventDefault(),d&&Ne(m.update(d.id).url,{onSuccess:()=>{q(null),Se()}})},e[5]=d,e[6]=Ne,e[7]=Se,e[8]=ee):ee=e[8];const Ce=ee;let te;e[9]!==r||e[10]!==o?(te=s=>{s.preventDefault(),Ee.get(m.index().url,{search:r,status:o},{preserveState:!0,preserveScroll:!0})},e[9]=r,e[10]=o,e[11]=te):te=e[11];const Te=te;let se;e[12]!==h||e[13]!==we?(se=()=>{h&&we(m.destroy(h.id).url,{onSuccess:()=>{Q(null)}})},e[12]=h,e[13]=we,e[14]=se):se=e[14];const De=se,st=Bt,Xe=Ht;let le;e[15]===Symbol.for("react.memo_cache_sentinel")?(le=t.jsx(at,{title:"Quản lý Bookings"}),e[15]=le):le=e[15];let f;e[16]!==c?(f=c?.success&&t.jsxs(Oe,{variant:"default",className:"border-green-200 bg-green-50",children:[t.jsx(wt,{className:"h-4 w-4 text-green-600"}),t.jsx($e,{className:"text-green-800",children:"Thành công!"}),t.jsx(Re,{className:"text-green-700",children:c.success})]}),e[16]=c,e[17]=f):f=e[17];let g;e[18]!==c?(g=c?.error&&t.jsxs(Oe,{variant:"destructive",children:[t.jsx(Ct,{className:"h-4 w-4"}),t.jsx($e,{children:"Lỗi!"}),t.jsx(Re,{children:c.error})]}),e[18]=c,e[19]=g):g=e[19];let ae;e[20]===Symbol.for("react.memo_cache_sentinel")?(ae=t.jsx("h2",{className:"text-2xl font-bold",children:"Danh sách Bookings"}),e[20]=ae):ae=e[20];let re;e[21]===Symbol.for("react.memo_cache_sentinel")?(re=m.create(),e[21]=re):re=e[21];let ie;e[22]===Symbol.for("react.memo_cache_sentinel")?(ie=t.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[ae,t.jsx($,{href:re.url,children:t.jsxs(i,{className:"bg-blue-600 hover:bg-blue-700",children:[t.jsx(Tt,{className:"mr-2 h-4 w-4"})," Thêm booking"]})})]}),e[22]=ie):ie=e[22];let ne;e[23]===Symbol.for("react.memo_cache_sentinel")?(ne=s=>Pe(s.target.value),e[23]=ne):ne=e[23];let j;e[24]!==r?(j=t.jsx(pt,{type:"text",placeholder:"Tìm kiếm theo mã, tên khách, email, tên tour...",value:r,onChange:ne,className:"max-w-md"}),e[24]=r,e[25]=j):j=e[25];const _e=o!==null?String(o):"all";let p;e[26]!==r?(p=s=>{const Ke=s==="all"?null:parseInt(s);Ve(Ke),Ee.get(m.index().url,{search:r,status:Ke},{preserveState:!0,preserveScroll:!0})},e[26]=r,e[27]=p):p=e[27];let ce;e[28]===Symbol.for("react.memo_cache_sentinel")?(ce=t.jsx(qe,{className:"w-[180px]",children:t.jsx(Qe,{placeholder:"Tất cả trạng thái"})}),e[28]=ce):ce=e[28];let oe;e[29]===Symbol.for("react.memo_cache_sentinel")?(oe=t.jsxs(Ge,{children:[t.jsx(n,{value:"all",children:"Tất cả trạng thái"}),t.jsx(n,{value:"0",children:"Chờ xử lý"}),t.jsx(n,{value:"1",children:"Đã xác nhận"}),t.jsx(n,{value:"2",children:"Đã hủy"}),t.jsx(n,{value:"3",children:"Hoàn thành"})]}),e[29]=oe):oe=e[29];let b;e[30]!==_e||e[31]!==p?(b=t.jsxs(Je,{value:_e,onValueChange:p,children:[ce,oe]}),e[30]=_e,e[31]=p,e[32]=b):b=e[32];let me;e[33]===Symbol.for("react.memo_cache_sentinel")?(me=t.jsx(i,{type:"submit",children:"Tìm kiếm"}),e[33]=me):me=e[33];let y;e[34]!==r||e[35]!==o?(y=(r||o!==null)&&t.jsx(i,{type:"button",variant:"outline",onClick:()=>{Pe(""),Ve(null),Ee.get(m.index().url)},children:"Xóa bộ lọc"}),e[34]=r,e[35]=o,e[36]=y):y=e[36];let v;e[37]!==j||e[38]!==b||e[39]!==y?(v=t.jsxs("div",{className:"flex gap-2",children:[j,b,me,y]}),e[37]=j,e[38]=b,e[39]=y,e[40]=v):v=e[40];let N;e[41]!==Te||e[42]!==v?(N=t.jsx("form",{onSubmit:Te,className:"mb-4",children:v}),e[41]=Te,e[42]=v,e[43]=N):N=e[43];let S;e[44]!==l.data||e[45]!==l.from||e[46]!==l.links||e[47]!==l.to||e[48]!==l.total||e[49]!==u?(S=t.jsx("div",{className:"hidden md:block",children:l.data&&l.data.length>0?t.jsxs(t.Fragment,{children:[t.jsxs(yt,{children:[t.jsx(vt,{children:t.jsxs(We,{children:[t.jsx(M,{children:"Mã Booking"}),t.jsx(M,{children:"Tour"}),t.jsx(M,{children:"Khách hàng"}),t.jsx(M,{children:"Ngày đi"}),t.jsx(M,{children:"Trạng thái"}),t.jsx(M,{className:"text-right",children:"Hành động"})]})}),t.jsx(Nt,{children:l.data.map(s=>t.jsxs(We,{children:[t.jsx(O,{className:"font-medium",children:s.code}),t.jsx(O,{children:s.tourInstance?.tourTemplate?.title||s.tour?.title||"N/A"}),t.jsx(O,{children:t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:s.client_name}),t.jsx("div",{className:"text-sm text-gray-500",children:s.client_email})]})}),t.jsx(O,{children:Xe(s.date_start)}),t.jsx(O,{children:t.jsx(Ue,{className:ve[s.status]?.color||"bg-gray-500",children:ve[s.status]?.label||"Unknown"})}),t.jsx(O,{className:"text-right",children:t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsx($,{href:m.show(s.id).url,children:t.jsx(i,{variant:"outline",size:"icon",className:"h-8 w-8",title:"Xem chi tiết",children:t.jsx(Ye,{className:"h-4 w-4"})})}),t.jsx(i,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>u(s),title:"Cập nhật trạng thái",children:t.jsx(Ze,{className:"h-4 w-4"})}),t.jsx(i,{variant:"destructive",size:"icon",className:"h-8 w-8",onClick:()=>Q(s),title:"Xóa booking",children:t.jsx(et,{className:"h-4 w-4"})})]})})]},s.id))})]}),l.links&&l.links.length>3&&t.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[t.jsxs("div",{className:"text-sm text-gray-700",children:["Hiển thị ",l.from||0," ","đến ",l.to||0," trong tổng số ",l.total||0," ","bookings"]}),t.jsx("div",{className:"flex gap-2",children:l.links.map(At)})]})]}):t.jsx("div",{className:"py-8 text-center text-gray-500",children:"Không tìm thấy booking nào."})}),e[44]=l.data,e[45]=l.from,e[46]=l.links,e[47]=l.to,e[48]=l.total,e[49]=u,e[50]=S):S=e[50];let w;e[51]!==l.data||e[52]!==u?(w=l.data&&l.data.length>0?l.data.map(s=>t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:[t.jsxs("div",{className:"flex justify-between items-start mb-3",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-bold text-gray-900",children:s.code}),t.jsx("div",{className:"text-xs text-gray-500",children:Xe(s.date_start)})]}),t.jsx(Ue,{className:ve[s.status]?.color||"bg-gray-500",children:ve[s.status]?.label||"Unknown"})]}),t.jsx("div",{className:"mb-3",children:t.jsx("div",{className:"font-medium text-gray-800 line-clamp-2",children:s.tourInstance?.tourTemplate?.title||s.tour?.title||"N/A"})}),t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm text-gray-600 mb-3 bg-gray-50 p-2 rounded",children:[t.jsxs("div",{children:[t.jsx("span",{className:"block text-xs text-gray-400 uppercase",children:"Khách hàng"}),t.jsx("span",{className:"font-medium",children:s.client_name})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("span",{className:"block text-xs text-gray-400 uppercase",children:"Tổng tiền"}),t.jsx("span",{className:"font-bold text-green-600",children:st(s.final_price)})]}),t.jsxs("div",{className:"col-span-2 text-xs border-t pt-2 mt-1 border-gray-200",children:[s.count_adult," người lớn",s.count_children>0&&`, ${s.count_children} trẻ em`]})]}),t.jsxs("div",{className:"flex gap-2 border-t pt-3",children:[t.jsx($,{href:m.show(s.id).url,className:"flex-1",children:t.jsxs(i,{variant:"outline",size:"sm",className:"w-full",children:[t.jsx(Ye,{className:"mr-1 h-3 w-3"})," Chi tiết"]})}),t.jsxs(i,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>u(s),children:[t.jsx(Ze,{className:"mr-1 h-3 w-3"})," Cập nhật"]}),t.jsx(i,{variant:"ghost",size:"sm",className:"w-10 px-0 text-red-600 hover:bg-red-50 hover:text-red-700",onClick:()=>Q(s),children:t.jsx(et,{className:"h-4 w-4"})})]})]},s.id)):t.jsx("div",{className:"py-8 text-center text-gray-500 bg-gray-50 rounded border border-dashed",children:"Không tìm thấy booking nào."}),e[51]=l.data,e[52]=u,e[53]=w):w=e[53];let C;e[54]!==l.links?(C=l.links&&l.links.length>3&&t.jsx("div",{className:"flex items-center justify-center gap-2 mt-4",children:l.links.map(_t)}),e[54]=l.links,e[55]=C):C=e[55];let T;e[56]!==w||e[57]!==C?(T=t.jsxs("div",{className:"md:hidden space-y-4",children:[w,C]}),e[56]=w,e[57]=C,e[58]=T):T=e[58];let D;e[59]!==N||e[60]!==S||e[61]!==T?(D=t.jsxs("div",{className:"rounded-lg bg-white p-6 shadow",children:[ie,N,S,T]}),e[59]=N,e[60]=S,e[61]=T,e[62]=D):D=e[62];let _;e[63]!==g||e[64]!==D||e[65]!==f?(_=t.jsxs("div",{className:"space-y-4 p-6",children:[f,g,D]}),e[63]=g,e[64]=D,e[65]=f,e[66]=_):_=e[66];const Ae=!!d;let de;e[67]===Symbol.for("react.memo_cache_sentinel")?(de=s=>!s&&q(null),e[67]=de):de=e[67];const He=d?.code;let A;e[68]!==He?(A=t.jsx(xt,{children:t.jsxs(ut,{children:["Cập nhật trạng thái: ",He]})}),e[68]=He,e[69]=A):A=e[69];let he;e[70]===Symbol.for("react.memo_cache_sentinel")?(he=t.jsx(bt,{children:"Trạng thái"}),e[70]=he):he=e[70];const Be=String(tt.status);let H;e[71]!==x?(H=s=>x("status",parseInt(s)),e[71]=x,e[72]=H):H=e[72];let xe;e[73]===Symbol.for("react.memo_cache_sentinel")?(xe=t.jsx(qe,{children:t.jsx(Qe,{placeholder:"Chọn trạng thái"})}),e[73]=xe):xe=e[73];let ue;e[74]===Symbol.for("react.memo_cache_sentinel")?(ue=t.jsxs(Ge,{children:[t.jsx(n,{value:"0",children:"Chờ xử lý"}),t.jsx(n,{value:"1",children:"Đã xác nhận"}),t.jsx(n,{value:"2",children:"Đã hủy"}),t.jsx(n,{value:"3",children:"Hoàn thành"})]}),e[74]=ue):ue=e[74];let B;e[75]!==Be||e[76]!==H?(B=t.jsxs(Je,{value:Be,onValueChange:H,children:[xe,ue]}),e[75]=Be,e[76]=H,e[77]=B):B=e[77];let k;e[78]!==W.status?(k=W.status&&t.jsx("div",{className:"text-sm text-red-500",children:W.status}),e[78]=W.status,e[79]=k):k=e[79];let I;e[80]!==B||e[81]!==k?(I=t.jsxs("div",{className:"space-y-2",children:[he,B,k]}),e[80]=B,e[81]=k,e[82]=I):I=e[82];let fe;e[83]===Symbol.for("react.memo_cache_sentinel")?(fe=t.jsx(i,{type:"button",variant:"ghost",onClick:()=>q(null),children:"Hủy"}),e[83]=fe):fe=e[83];const ke=J?"Đang lưu...":"Lưu thay đổi";let L;e[84]!==J||e[85]!==ke?(L=t.jsxs(ft,{children:[fe,t.jsx(i,{type:"submit",disabled:J,children:ke})]}),e[84]=J,e[85]=ke,e[86]=L):L=e[86];let F;e[87]!==Ce||e[88]!==I||e[89]!==L?(F=t.jsxs("form",{onSubmit:Ce,className:"space-y-4",children:[I,L]}),e[87]=Ce,e[88]=I,e[89]=L,e[90]=F):F=e[90];let E;e[91]!==A||e[92]!==F?(E=t.jsxs(gt,{children:[A,F]}),e[91]=A,e[92]=F,e[93]=E):E=e[93];let z;e[94]!==Ae||e[95]!==E?(z=t.jsx(jt,{open:Ae,onOpenChange:de,children:E}),e[94]=Ae,e[95]=E,e[96]=z):z=e[96];const Ie=!!h;let ge;e[97]===Symbol.for("react.memo_cache_sentinel")?(ge=s=>!s&&Q(null),e[97]=ge):ge=e[97];let je;e[98]===Symbol.for("react.memo_cache_sentinel")?(je=t.jsx(rt,{children:"Xác nhận xóa booking"}),e[98]=je):je=e[98];const Le=h?.code;let P;e[99]!==Le?(P=t.jsxs(it,{children:[je,t.jsxs(nt,{children:["Bạn có chắc chắn muốn xóa booking"," ",t.jsx("strong",{children:Le}),"? Hành động này không thể hoàn tác."]})]}),e[99]=Le,e[100]=P):P=e[100];let pe;e[101]===Symbol.for("react.memo_cache_sentinel")?(pe=t.jsx(ct,{children:"Hủy"}),e[101]=pe):pe=e[101];const Fe=Y?"Đang xóa...":"Xóa";let V;e[102]!==Y||e[103]!==De||e[104]!==Fe?(V=t.jsxs(ot,{children:[pe,t.jsx(mt,{onClick:De,disabled:Y,className:"bg-red-600 hover:bg-red-700",children:Fe})]}),e[102]=Y,e[103]=De,e[104]=Fe,e[105]=V):V=e[105];let X;e[106]!==P||e[107]!==V?(X=t.jsxs(dt,{children:[P,V]}),e[106]=P,e[107]=V,e[108]=X):X=e[108];let K;e[109]!==Ie||e[110]!==X?(K=t.jsx(ht,{open:Ie,onOpenChange:ge,children:X}),e[109]=Ie,e[110]=X,e[111]=K):K=e[111];let be;return e[112]!==_||e[113]!==z||e[114]!==K?(be=t.jsxs(St,{breadcrumbs:Dt,children:[le,_,z,K]}),e[112]=_,e[113]=z,e[114]=K,e[115]=be):be=e[115],be}function _t(a,e){return a.label.includes("&laquo;")||a.label.includes("&raquo;")||a.active?t.jsx($,{href:a.url||"#",className:`rounded-md px-3 py-2 text-sm font-medium ${a.active?"bg-blue-600 text-white":a.url?"border bg-white text-gray-700 hover:bg-gray-50":"cursor-not-allowed bg-gray-100 text-gray-400 opacity-50"}`,dangerouslySetInnerHTML:{__html:a.label}},e):null}function At(a,e){return t.jsx($,{href:a.url||"#",className:`rounded-md px-3 py-2 text-sm font-medium ${a.active?"bg-blue-600 text-white":a.url?"border bg-white text-gray-700 hover:bg-gray-50":"cursor-not-allowed bg-gray-100 text-gray-400"}`,dangerouslySetInnerHTML:{__html:a.label}},e)}function Ht(a){return new Date(a).toLocaleDateString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit"})}function Bt(a){return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0}).format(a)}export{js as default};
